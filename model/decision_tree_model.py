# Decision Tree Model Parameters
import numpy as np

tree_ = {
    'feature': [22, 27, 3, 24, 22, 13, 21, -2, 1, -2, -2, 16, -2, -2, 24, 22, 0, -2, -2, -2, -2, 20, -2, -2, 21, -2, -2, 21, 25, -2, -2, -2, 1, 7, -2, -2, 23, 27, -2, -2, 24, -2, 26, 20, -2, -2, -2],
    'threshold': [0.14469073712825775, 0.671095609664917, 0.10185965523123741, 1.96828955411911, -0.15995115786790848, 0.11909332498908043, 1.2259687781333923, -2.0, 0.8824929296970367, -2.0, -2.0, -0.4662511795759201, -2.0, -2.0, 0.18191853165626526, -0.15116341412067413, -0.09400369925424457, -2.0, -2.0, -2.0, -2.0, -0.949111133813858, -2.0, -2.0, -0.7286333367228508, -2.0, -2.0, -0.1844075843691826, 1.0596910119056702, -2.0, -2.0, -2.0, -1.04124116897583, 0.9418062716722488, -2.0, -2.0, -0.13833318650722504, 0.38653822243213654, -2.0, -2.0, -1.8802955150604248, -2.0, -0.4154985547065735, 0.4715382903814316, -2.0, -2.0, -2.0],
    'children_left': [1, 2, 3, 4, 5, 6, 7, -1, 9, -1, -1, 12, -1, -1, 15, 16, 17, -1, -1, -1, -1, 22, -1, -1, 25, -1, -1, 28, 29, -1, -1, -1, 33, 34, -1, -1, 37, 38, -1, -1, 41, -1, 43, 44, -1, -1, -1],
    'children_right': [32, 27, 24, 21, 14, 11, 8, -1, 10, -1, -1, 13, -1, -1, 20, 19, 18, -1, -1, -1, -1, 23, -1, -1, 26, -1, -1, 31, 30, -1, -1, -1, 36, 35, -1, -1, 40, 39, -1, -1, 42, -1, 46, 45, -1, -1, -1],
    'value': [[[0.6263736263736264, 0.37362637362637363]], [[0.9259259259259259, 0.07407407407407407]], [[0.9578947368421052, 0.042105263157894736]], [[0.9713261648745519, 0.02867383512544803]], [[0.9817518248175182, 0.01824817518248175]], [[0.9919028340080972, 0.008097165991902834]], [[0.9958847736625515, 0.00411522633744856]], [[1.0, 0.0]], [[0.9285714285714286, 0.07142857142857142]], [[0.0, 1.0]], [[1.0, 0.0]], [[0.75, 0.25]], [[0.0, 1.0]], [[1.0, 0.0]], [[0.8888888888888888, 0.1111111111111111]], [[0.96, 0.04]], [[0.5, 0.5]], [[0.0, 1.0]], [[1.0, 0.0]], [[1.0, 0.0]], [[0.0, 1.0]], [[0.4, 0.6]], [[1.0, 0.0]], [[0.0, 1.0]], [[0.3333333333333333, 0.6666666666666666]], [[1.0, 0.0]], [[0.0, 1.0]], [[0.16666666666666666, 0.8333333333333334]], [[0.6666666666666666, 0.3333333333333333]], [[0.0, 1.0]], [[1.0, 0.0]], [[0.0, 1.0]], [[0.06329113924050633, 0.9367088607594937]], [[0.7142857142857143, 0.2857142857142857]], [[1.0, 0.0]], [[0.0, 1.0]], [[0.033112582781456956, 0.9668874172185431]], [[0.6, 0.4]], [[1.0, 0.0]], [[0.0, 1.0]], [[0.0136986301369863, 0.9863013698630136]], [[1.0, 0.0]], [[0.006896551724137931, 0.993103448275862]], [[0.3333333333333333, 0.6666666666666666]], [[1.0, 0.0]], [[0.0, 1.0]], [[0.0, 1.0]]]
}
classes_ = np.array([0, 1])
n_classes_ = 2

def _predict_single(X, node=0):
    """Predict for a single sample"""
    if tree_['children_left'][node] == tree_['children_right'][node]:  # leaf node
        class_counts = np.array(tree_['value'][node][0])
        return classes_[np.argmax(class_counts)]
    
    if X[tree_['feature'][node]] <= tree_['threshold'][node]:
        return _predict_single(X, tree_['children_left'][node])
    else:
        return _predict_single(X, tree_['children_right'][node])

def predict(X):
    """Predict class labels"""
    X = np.array(X)
    if X.ndim == 1:
        return _predict_single(X)
    return np.array([_predict_single(x) for x in X])

def predict_proba(X):
    """Predict class probabilities"""
    X = np.array(X)
    if X.ndim == 1:
        node = 0
        while tree_['children_left'][node] != tree_['children_right'][node]:
            if X[tree_['feature'][node]] <= tree_['threshold'][node]:
                node = tree_['children_left'][node]
            else:
                node = tree_['children_right'][node]
        class_counts = np.array(tree_['value'][node][0])
        return class_counts / class_counts.sum()
    return np.array([predict_proba(x) for x in X])
